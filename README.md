# Rese  
飲食店予約・口コミ・店舗管理システム

---

## 目次

1. [主要機能](#主要機能)
2. [環境構築](#環境構築)
   - [Dockerビルド](#dockerビルド)
   - [Laravel環境構築](#laravel環境構築)
   - [メール認証（Mailtrap）](#メール認証mailtrap)
3. [テストアカウント](#テストアカウント)
4. [開発環境](#開発環境)
5. [技術スタック](#技術スタック)
6. [テーブル設計](#テーブル設計)
7. [ER図](#er図)
8. [口コミ機能](#口コミ機能)
9. [検索・ソート機能](#検索ソート機能)
10. [CSVインポート機能](#csvインポート機能)

---

## 主要機能

- ユーザー登録（Mailtrapによるメール認証）
- 飲食店の検索（地域/ジャンル/店名）・ソート（ランダム/評価順）
- 飲食店の閲覧・予約・お気に入り登録
- 飲食店への口コミ投稿・編集・削除
- 店舗代表者による店舗管理
- 管理者による店舗・口コミ・ユーザー管理
- QRコードによる予約確認表示
- 管理者によるCSVインポートによる店舗一括登録

[目次に戻る](#目次)

---

## 環境構築

### Dockerビルド

1. `git clone git@github.com:yuji-oonaka/Rese.git`
2. Docker Desktopを起動
3. `docker-compose up -d --build`

### Laravel環境構築

1. `docker-compose exec php bash`
2. `composer install`
3. `cp .env.example .env`
4. `php artisan key:generate`
5. `php artisan migrate`
6. `php artisan db:seed`
7. `php artisan storage:link`

[目次に戻る](#目次)

---

## メール認証（Mailtrap）

1. [Mailtrap](https://mailtrap.io/)でアカウントを作成しログイン
2. Inboxを作成し、「Integrations」から「Laravel」を選択しSMTP情報を取得
3. `.env`ファイルの`MAIL_MAILER`から`MAIL_ENCRYPTION`までをMailtrapの値に設定  
   `MAIL_FROM_ADDRESS`は任意のメールアドレスを指定
4. 会員登録後、MailtrapのInboxで認証メールを確認し、メール内リンクから認証を完了

[目次に戻る](#目次)

---

## テストアカウント

- 一般ユーザー  
  - name: 111  
  - email: 111@sample.com  
  - password: 111sample  
  または会員登録で任意のユーザーを作成

- 管理者  
  - name: admin  
  - email: admin@example.com  
  - password: password

- 店舗代表者  
  - name: 代表者1  
  - email: rep1@example.com  
  - password: password

[目次に戻る](#目次)

---

## 開発環境

- アプリケーション: http://localhost  
- 会員登録画面: http://localhost/register  
- phpMyAdmin: http://localhost:8080

[目次に戻る](#目次)

---

## 技術スタック

| 技術      | バージョン    |
|-----------|--------------|
| PHP       | 8.3.7        |
| Laravel   | 11.33.2      |
| MySQL     | 8.0.26       |
| nginx     | -            |
| Mailtrap  | 最新版       |

[目次に戻る](#目次)

---

---

## テーブル設計
![スクリーンショット 2025-04-25 121505](https://github.com/user-attachments/assets/b87aca5a-4857-4599-9502-33474ff83beb)

![スクリーンショット 2025-04-25 121514](https://github.com/user-attachments/assets/a7294336-6df4-41c1-bcc7-41bad4175a82)

[目次に戻る](#目次)

---


## ER図

![attendace drawio (4)](https://github.com/user-attachments/assets/7d74d648-1613-4874-ace9-f49c016ed47a)

[目次に戻る](#目次)

---

## 口コミ機能

- 口コミは「店舗来店予定日時終了後」から投稿可能です。
- 一般ユーザーは1店舗につき1件のみ口コミ投稿可能  
  - 自身の口コミのみ編集・削除可能
- 管理者ユーザーは全ての口コミを削除可能（追加・編集不可）
- 店舗代表者は口コミの追加・編集・削除は不可

|            | 新規口コミ追加 | 口コミ編集 | 口コミ削除 |
|------------|:--------------:|:----------:|:----------:|
| 一般ユーザー | ○（1店舗1件） | ○（自身のみ） | ○（自身のみ） |
| 店舗代表者   | ×              | ×           | ×           |
| 管理者ユーザー | ×              | ×           | ○（全件）    |

[目次に戻る](#目次)

---

---

## 検索・ソート機能

### 検索条件
- **地域**：東京都/大阪府/福岡県から選択
- **ジャンル**：寿司/焼肉/イタリアン/居酒屋/ラーメンから選択
- **店名**：部分一致検索（キーワード入力）

### ソートオプション
1. **ランダム表示**  
   - 選択する度に店舗の並び順が不規則に変化
2. **評価高い順**  
   - 評価平均が高い順に表示（未評価店舗は最後尾）
3. **評価低い順**  
   - 評価平均が低い順に表示（未評価店舗は最後尾）

### 評価表示
- 各店舗に評価平均を星評価で表示（例：★4.2）
- 評価数と平均値はページアクセス時にリアルタイム更新
- 新規評価後、リロードなしで即時反映

[目次に戻る](#目次)

---

## CSVインポート機能

管理者ユーザーは、CSVファイルをインポートすることで新規店舗情報を一括追加できます。  
店舗作成ページにてファイルを選択し、内容を確認後インポートできます。  
テスト用のCSVファイル（店舗作成用.csv）はプロジェクトディレクトリ直下に作成しています。

### CSVファイルの記述方法

CSVファイルは以下のフォーマットで作成してください（**すべての項目が必須**）。

| 店舗名    | 地域   | ジャンル   | 店舗概要                | 画像URL         |
|-----------|--------|------------|-------------------------|-----------------|
| 寿司太郎  | 東京都 | 寿司       | 新鮮なネタの寿司店です  | sushitaro.jpg   |
| 焼肉花子  | 大阪府 | 焼肉       | 厳選和牛の焼肉店        | hanako.png      |

- 店舗名：50文字以内
- 地域：「東京都」「大阪府」「福岡県」のいずれか
- ジャンル：「寿司」「焼肉」「イタリアン」「居酒屋」「ラーメン」のいずれか
- 店舗概要：400文字以内
- 画像URL：jpg、jpeg、pngのみ対応（非対応拡張子はエラー）

[目次に戻る](#目次)
